<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Payloads Layout - IOTA 2.0 Research Specifications</title>
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="favicon.svg">
                        <link rel="shortcut icon" href="favicon.png">
                <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
                <link rel="stylesheet" href="css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
                <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="0.0 Preface.html">Preface</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">1.</strong> Control Files</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="1.1 Introduction.html"><strong aria-hidden="true">1.1.</strong> Introduction</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">1.2.</strong> Table of Contents</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">1.3.</strong> Terminology</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">1.4.</strong> Index of parameters</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">1.5.</strong> References</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.</strong> Structure</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">2.1.</strong> Data Types</div></li><li class="chapter-item expanded "><a href="2.2 Message Layout.html"><strong aria-hidden="true">2.2.</strong> Message Layout</a></li><li class="chapter-item expanded "><a href="2.3 Standard Payloads Layout.html" class="active"><strong aria-hidden="true">2.3.</strong> Payloads Layout</a></li><li class="chapter-item expanded "><a href="2.4 Data flow.html"><strong aria-hidden="true">2.4.</strong> Data Flow</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.</strong> Network Layer</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">3.1.</strong> Communication Models</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.2.</strong> Bootstrapping</div></li><li class="chapter-item expanded "><a href="3.3 Peer Discovery.html"><strong aria-hidden="true">3.3.</strong> Peer Discovery</a></li><li class="chapter-item expanded "><a href="3.4 Neighbor Selection.html"><strong aria-hidden="true">3.4.</strong> Neighbor Selection</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.5.</strong> Manual Peering</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.</strong> Communication Layer</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="4.1 The Tangle.html"><strong aria-hidden="true">4.1.</strong> The Tangle</a></li><li class="chapter-item expanded "><a href="4.2 Timestamps.html"><strong aria-hidden="true">4.2.</strong> Timestamps</a></li><li class="chapter-item expanded "><a href="4.3 Tip Selection Algorithm.html"><strong aria-hidden="true">4.3.</strong> Tip Selection Algorithm</a></li><li class="chapter-item expanded "><a href="4.4 Solidification.html"><strong aria-hidden="true">4.4.</strong> Solidification</a></li><li class="chapter-item expanded "><a href="4.5 Rate Control.html"><strong aria-hidden="true">4.5.</strong> Rate Control</a></li><li class="chapter-item expanded "><a href="4.6 Congestion Control.html"><strong aria-hidden="true">4.6.</strong> Congestion Control</a></li><li class="chapter-item expanded "><a href="4.7 Markers.html"><strong aria-hidden="true">4.7.</strong> Markers</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.8.</strong> Message Creation</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.</strong> Value Transfer Application</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="5.1 UTXO.html"><strong aria-hidden="true">5.1.</strong> UTXO</a></li><li class="chapter-item expanded "><a href="5.2 Ledger State.html"><strong aria-hidden="true">5.2.</strong> Ledger State</a></li><li class="chapter-item expanded "><a href="5.3 Mana.html"><strong aria-hidden="true">5.3.</strong> Mana</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.</strong> Consensus Applications</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="6.1 Objects of Consensus.html"><strong aria-hidden="true">6.1.</strong> Object of Consensus</a></li><li class="chapter-item expanded "><a href="6.2 Opinion Setting.html"><strong aria-hidden="true">6.2.</strong> Opinion Setting</a></li><li class="chapter-item expanded "><a href="6.3 Fast Probabilistic Consensus.html"><strong aria-hidden="true">6.3.</strong> FPC</a></li><li class="chapter-item expanded "><a href="6.4 Finalization.html"><strong aria-hidden="true">6.4.</strong> Finalization</a></li><li class="chapter-item expanded "><a href="6.5 dRNG.html"><strong aria-hidden="true">6.5.</strong> dRNG</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><div>Appendix</div></li><li class="chapter-item expanded affix "><div>Snapshots</div></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">IOTA 2.0 Research Specifications</h1>

                    <div class="right-buttons">
                                                <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="23-standard-payloads-layout"><a class="header" href="#23-standard-payloads-layout">2.3 Standard Payloads Layout</a></h1>
<p>Payloads may contain arbitrary data up to <code>MAX_PAYLOAD_SIZE</code>, which allows building additional protocols on top of the base protocol in the same way as TCP/IP allows to define additional protocols on top of its generic data segment.</p>
<p>Payloads may recursively contain other payloads, that enables the creation of higher-level protocols based on the same concepts of layers, as in traditional software and network architecture.</p>
<p>Payloads other than transactions are, by definition, always liked with a level of knowledge 3.</p>
<h2 id="231-dependencies"><a class="header" href="#231-dependencies">2.3.1 Dependencies</a></h2>
<p>The Standard payload Layout specification depends on the following specification:</p>
<ul>
<li><a href="./2.2%20Message%20Layout.html">2.2 - Message Layout</a></li>
</ul>
<h2 id="232-payload-definition-guideline"><a class="header" href="#232-payload-definition-guideline">2.3.2 Payload definition guideline</a></h2>
<p>Each payload shall be described by the <code>uint32</code> <strong>payload type</strong> field. To separate user-defined payloads from essential core payloads and allow future extension of the protocol, the first four places (types 0-255) are reserved for core payload definitions, and all user-defined payloads that do not restrict this rule shall be discarded.</p>
<p>Additionally, all payloads shall start with the following fields, in the presented order (Table 2.3.1).</p>
<table>
    <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
    </tr>
    <tr>
        <td>Size</td>
        <td>uint32</td>
        <td>The size of the payload.</td>
    </tr>
    <tr>
        <td>Payload Type</td>
        <td>uint32</td>
        <td>The type of the payload.</td>
    </tr>
    <tr>
        <td>Version</td>
        <td>uint8</td>
        <td>The version of the payload.</td>
    </tr>
</table>
<p><em>Table 2.3.1 Required fields of a payload.</em></p>
<h2 id="233-parameters"><a class="header" href="#233-parameters">2.3.3 Parameters</a></h2>
<p>The Table 2.3.2 presents the parameter list that each node must know.
| Name | Description | Value |
| -----| ------ | ----------- |
|<code>MAX_PAYLOAD_SIZE</code> | The maximum allowed payload size in bytes. Determined by the difference between <code>MAX_MESSAGE_SIZE</code> (defined in <a href="./2.2%20Message%20Layout.html">Section 2.2 - Message Layout</a>) and the total size of the remaining message fields. | 65157 |</p>
<p><em>Table 2.3.2 Standard Payload Layout parameters.</em></p>
<h2 id="234-user-defined-payloads"><a class="header" href="#234-user-defined-payloads">2.3.4 User-defined payloads</a></h2>
<p>A node may choose to interpret user-defined payloads by listening to its specific <strong>payload type</strong> (possibly via third-party code/software). If a node does not know a certain <strong>payload type</strong>, it simply treats it as arbitrary data.</p>
<h2 id="235-core-payloads"><a class="header" href="#235-core-payloads">2.3.5 Core payloads</a></h2>
<p>The core protocol defines several payloads that every node needs to interpret and process in order to participate in the network.
All core payloads, along with their types, are listed in the Table 2.3.3.</p>
<table>
    <tr>
        <th>Payload Name</th>
        <th>Payload Type</th>
    </tr>
    <tr>
        <td>Pure data</td>
        <td>value 1</td>
    </tr>
    <tr>
        <td>Transaction</td>
        <td>value 0</td>
    </tr>
    <tr>
        <td>FPC statement</td>
        <td>value 2</td>
    </tr>
    <tr>
        <td>dRNG Application Message</td>
        <td>value 3</td>
    </tr>
    <tr>
        <td>dRNG DKG</td>
        <td>value 4</td>
    </tr>
    <tr>
        <td>dRNG Beacon</td>
        <td>value 5</td>
    </tr>
    <tr>
        <td>dRNG Collective Beacon</td>
        <td>value 6</td>
    </tr>
    <tr>
        <td>Salt Declaration</td>
        <td>value 7</td>
    </tr>
    <tr>
        <td>Indexation</td>
        <td>value 8</td>
    </tr>
</table>
<p><em>Table 2.3.3 List of all core payloads with its corresponding types.</em></p>
<h3 id="2351-pure-data-payload"><a class="header" href="#2351-pure-data-payload">2.3.5.1 Pure data payload</a></h3>
<p>Pure data payloads allow to send unsigned messages (Table 2.3.4). </p>
<table>
    <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
    </tr>
    <tr>
        <td>Size</td>
        <td>uint32</td>
        <td>The size of the payload.</td>
    </tr>
    <tr>
        <td>Payload Type</td>
        <td>uint32</td>
        <td>
        Set to <strong>value 1</strong> to denote a <i>Data Payload</i>.
        </td>
    </tr>
    <tr>
        <td>Version</td>
        <td>uint8</td>
        <td>The version of the payload.</td>
    </tr>
    <tr>
        <td>Data</td>
        <td>ByteArray</td>
        <td>The raw data payload.</td>
    </tr>
</table>
<p><em>Table 2.3.4 Pure data payload.</em></p>
<h3 id="2352-transaction-payload"><a class="header" href="#2352-transaction-payload">2.3.5.2 Transaction payload</a></h3>
<p>The ledger state is changed through transactions payloads or value transfers. More details on transactions could be found in <a href="./5.1%20UTXO.html">Section 5.1 - UTXO</a> specification.
The detailed description of transaction payload's serialized form is presented in Table 2.3.5.</p>
<table>
    <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
    </tr>
    <tr>
        <td>Size</td>
        <td>uint32</td>
        <td>The size of the payload.</td>
    </tr>
    <tr>
        <td>Payload Type</td>
        <td>uint32</td>
        <td>
        Set to <strong>value 0</strong> to denote a <i>Transaction Payload</i>.
        </td>
    </tr>
    <tr>
        <td>Version</td>
        <td>uint8</td>
        <td>The version of the payload.</td>
    </tr>
    <tr>
        <td valign="top">Essence <code>oneOf</code></td>
        <td colspan="2">
            <details open="true">
                <summary>Transaction Essence</summary>
                <blockquote>
                Describes the essence data making up a transaction.
                </blockquote>
                <table>
                    <tr>
                        <td><b>Name</b></td>
                        <td><b>Type</b></td>
                        <td><b>Description</b></td>
                    </tr>
                    <tr>
                        <td>Version</td>
                        <td>uint8</td>
                        <td>
                        The version number of the <i>Transaction Essence</i>.
                        </td>
                    </tr>
                    <tr>
                        <td>Timestamp</td>
                        <td>time</td>
                        <td>
                        The timestamp of the <i>Transaction</i> creation.
                        </td>
                    </tr>
                    <tr>
                        <td>Access Mana Pledge nodeID</td>
                        <td>ByteArray[32]</td>
                        <td>
                        The nodeID to which access mana of the <i>Transaction</i> is pledged.
                        </td>
                    </tr>
                    <tr>
                        <td>Consensus Mana Pledge nodeID</td>
                        <td>ByteArray32]</td>
                        <td>
                        The nodeID to which consensus mana of the <i>Transaction</i> is pledged.
                        </td>
                    </tr>
                    <tr>
                        <td>Inputs Count</td>
                        <td>uint16</td>
                        <td>The amount of inputs proceeding.</td>
                    </tr>
                    <tr>
                        <td valign="top">Inputs <code>anyOf</code></td>
                        <td colspan="2">
                            <details>
                                <summary>UTXO Input</summary>
                                <blockquote>
                                Describes an input which references an unspent transaction output to consume.
                                </blockquote>
                                <table>
                                    <tr>
                                        <td><b>Name</b></td>
                                        <td><b>Type</b></td>
                                        <td><b>Description</b></td>
                                    </tr>
                                    <tr>
                                        <td>Input Type</td>
                                        <td>uint8</td>
                                        <td>
                                            Set to <strong>value 0</strong> to denote an <i>UTXO Input</i>.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Transaction ID</td>
                                        <td>ByteArray[32]</td>
                                        <td>The BLAKE2b-256 hash of the transaction from which the UTXO comes from.</td>
                                    </tr>
                                    <tr>
                                        <td>Transaction Output Index</td>
                                        <td>uint16</td>
                                        <td>The index of the output on the referenced transaction to consume.</td>
                                    </tr>
                                </table>
                            </details>
                        </td>
                    </tr>
                   <tr>
                        <td>Outputs Count</td>
                        <td>uint16</td>
                        <td>The amount of outputs proceeding.</td>
                    </tr>
                   <tr>
                        <td valign="top">Outputs <code>anyOf</code></td>
                        <td colspan="2">
                            <details>
                                <summary>SigLockedSingleOutput</summary>
                                <blockquote>
                                Describes a deposit to a single address which is unlocked via a signature.
                                </blockquote>
                                <table>
                                    <tr>
                                        <td><b>Name</b></td>
                                        <td><b>Type</b></td>
                                        <td><b>Description</b></td>
                                    </tr>
                                    <tr>
                                        <td>Output Type</td>
                                        <td>uint8</td>
                                        <td>
                                            Set to <strong>value 0</strong> to denote a <i>SigLockedSingleOutput</i>.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td valign="top">Address <code>oneOf</code></td>
                                        <td colspan="2">
                                            <details>
                                                <summary>Ed25519 Address</summary>
                                                <table>
                                                    <tr>
                                                        <td><b>Name</b></td>
                                                        <td><b>Type</b></td>
                                                        <td><b>Description</b></td>
                                                    </tr>
                                                    <tr>
                                                        <td>Address Type</td>
                                                        <td>uint8</td>
                                                        <td>
                                                            Set to <strong>value 0</strong> to denote an <i>Ed25519 Address</i>.
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>Address</td>
                                                        <td>ByteArray[32]</td>
                                                        <td>The raw bytes of the Ed25519 address which is a BLAKE2b-256 hash of the Ed25519 public key.</td>
                                                    </tr>
                                                </table>
                                            </details>
                                            <details>
                                                <summary>BLS Address</summary>
                                                <table>
                                                    <tr>
                                                        <td><b>Name</b></td>
                                                        <td><b>Type</b></td>
                                                        <td><b>Description</b></td>
                                                    </tr>
                                                    <tr>
                                                        <td>Address Type</td>
                                                        <td>uint8</td>
                                                        <td>
                                                            Set to <strong>value 1</strong> to denote a <i>BLS Address</i>.
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>Address</td>
                                                        <td>ByteArray[49]</td>
                                                        <td>The raw bytes of the BLS address which is a BLAKE2b-256 hash of the BLS public key.</td>
                                                    </tr>
                                                </table>
                                            </details>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Amount</td>
                                        <td>uint64</td>
                                        <td>The amount of tokens to deposit with this <i>SigLockedSingleOutput</i> output.</td>
                                    </tr>
                                </table>
                            </details>
                        </td>
                    </tr>
                    <tr>
                        <td>Payload Length</td>
                        <td>uint32</td>
                        <td>The length in bytes of the optional payload.</td>
                    </tr>
                   <tr>
                        <td valign="top">Payload <code>optOneOf</code></td>
                        <td colspan="2">
                            <details>
                                <summary>Indexation Payload</summary>
                            </details>
                        </td>
                    </tr>
                </table>
            </details>
        </td>
    </tr>
    <tr>
        <td>Unlock Blocks Count</td>
        <td>uint16</td>
        <td>The count of unlock blocks proceeding. Must match count of specified inputs.</td>
    </tr>
    <tr>
        <td valign="top">Unlock Blocks <code>anyOf</code></td>
        <td colspan="2">
            <details open="true">
                <summary>Signature Unlock Block</summary>
                <blockquote>
                Defines an unlock block containing signature(s) unlocking input(s).
                </blockquote>
                <table>
                    <tr>
                        <th>Name</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td>Unlock Type</td>
                        <td>uint8</td>
                        <td>
                            Set to <strong>value 0</strong> to denote a <i>Signature Unlock Block</i>.
                        </td>
                    </tr>
                    <tr>
                        <td valign="top">Signature <code>oneOf</code></td>
                        <td colspan="2">
                             <details>
                                <summary>Ed25519 Signature</summary>
                                <table>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                        <th>Description</th>
                                    </tr>
                                    <tr>
                                        <td>Signature Type</td>
                                        <td>uint8</td>
                                        <td>
                                            Set to <strong>value 1</strong> to denote an <i>Ed25519 Signature</i>.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Public key</td>
                                        <td>ByteArray[32]</td>
                                        <td>The public key of the Ed25519 keypair which is used to verify the signature.</td>
                                    </tr>
                                    <tr>
                                        <td>Signature</td>
                                        <td>ByteArray[64]</td>
                                        <td>The signature signing the serialized <i>Transaction Essence</i>.</td>
                                    </tr>
                                </table>
                            </details>
                            <details>
                                <summary>BLS Signature</summary>
                                <table>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                        <th>Description</th>
                                    </tr>
                                    <tr>
                                        <td>Signature Type</td>
                                        <td>uint8</td>
                                        <td>
                                            Set to <strong>value 1</strong> to denote a <i>BLS Signature</i>.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Signature</td>
                                        <td>ByteArray</td>
                                        <td>The signature signing the serialized <i>Transaction Essence</i>.</td>
                                    </tr>
                                </table>
                            </details>
                        </td>
                    </tr>
                </table>
            </details>
            <details open="true">
                <summary>Reference Unlock Block</summary>
                <blockquote>
                References a previous unlock block in order to substitute the duplication of the same unlock block data for inputs which unlock through the same data.
                </blockquote>
                <table>
                    <tr>
                        <th>Name</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td>Unlock Type</td>
                        <td>uint8</td>
                        <td>
                            Set to <strong>value 1</strong> to denote a <i>Reference Unlock Block</i>.
                        </td>
                    </tr>
                    <tr>
                        <td>Reference</td>
                        <td>uint16</td>
                        <td>Represents the index of a previous unlock block.</td>
                    </tr>
                </table>
            </details>
        </td>
    </tr>
</table>
<p><em>Table 2.3.5 Transaction payload.</em></p>
<h3 id="2353-fpc-statement"><a class="header" href="#2353-fpc-statement">2.3.5.3 FPC statement</a></h3>
<p>Opinions on conflicts of transactions and timestamps of the messages, mainly issued by high mana nodes. Details regarding FPC see <a href="./6.3%20Fast%20Probabilistic%20Consensus.html">Section 6.3 - Fast Probabilistic Consensus</a> specification.</p>
<p>The Table 2.3.6 describes the entirety of a <i>FPC statement</i>'s serialized form.</p>
<table>
    <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
    </tr>
    <tr>
        <td>Size</td>
        <td>uint32</td>
        <td>The size of the FPC statement payload.</td>
    </tr>
    <tr>
        <td>Payload Type</td>
        <td>uint32</td>
        <td>
        Set to <strong>2</strong> to denote a <i>FPC statement Payload</i>.
        </td>
    </tr>
    <tr>
        <td>Version</td>
        <td>uint8</td>
        <td>The version of the FPC statement payload.</td>
    </tr>
    <tr>
        <td>Conflicts Count</td>
        <td>uint32</td>
        <td>The number of conflicts proceeding.</td>
    </tr>
    <tr>
        <td valign="top">Conflicts <code>optOneOf</code></td>
        <td colspan="2">
            <details open="true">
                <summary>Conflict</summary>
                <blockquote>
                    Describes a voting details in a given round for a transaction conflict.
                </blockquote>
                <table>
                    <tr>
                        <td><b>Name</b></td>
                        <td><b>Type</b></td>
                        <td><b>Description</b></td>
                    </tr>
                    <tr>
                        <td>TransactionID</td>
                        <td>ByteArray[32]</td>
                        <td>The ID of the conflicting transaction.</td>
                    </tr>
                    <tr>
                        <td valign="top">Opinion</td>
                        <td colspan="2">
                            <details open="true">
                                <summary>Represents the node's opinion value over the conflict in a given round.</summary>
                                <table>
                                    <tr>
                                        <td><b>Name</b></td>
                                        <td><b>Type</b></td>
                                        <td><b>Description</b></td>
                                    </tr>
                                    <tr>
                                        <td>Value</td>
                                        <td>uint8</td>
                                        <td>The node's opinion value in a given round.</td>
                                    </tr>
                                    <tr>
                                        <td>Round</td>
                                        <td>uint8</td>
                                        <td>The round number.</td>
                                    </tr>
                                </table>
                            </details>
                        </td>
                    </tr>
                </table>
            </details>
        </td>
    </tr>
    <tr>
        <td>Timestamps Count</td>
        <td>uint32</td>
        <td>The number of timestamp voting proceeding.</td>
    </tr>
    <tr>
        <td valign="top">Timestamps <code>optOneOf</code></td>
        <td colspan="2">
            <details open="true">
                <summary>Timestamp</summary>
                <blockquote>
                    Describes the voting details over the timestamp for a given message and round.
                </blockquote>
                <table>
                    <tr>
                        <td><b>Name</b></td>
                        <td><b>Type</b></td>
                        <td><b>Description</b></td>
                    </tr>
                    <tr>
                        <td>MessageID</td>
                        <td>ByteArray[32]</td>
                        <td>The ID of the message that contains the timestamp.</td>
                    </tr>
                    <tr>
                        <td valign="top">Opinion</td>
                        <td colspan="2">
                            <details open="true">
                                <summary>Represents the node's opinion value over the conflict in a given round.</summary>
                                <table>
                                    <tr>
                                        <td><b>Name</b></td>
                                        <td><b>Type</b></td>
                                        <td><b>Description</b></td>
                                    </tr>
                                    <tr>
                                        <td>Value</td>
                                        <td>uint8</td>
                                        <td>The node's opinion value in a given round.</td>
                                    </tr>
                                    <tr>
                                        <td>Round</td>
                                        <td>uint8</td>
                                        <td>The round number.</td>
                                    </tr>
                                </table>
                            </details>
                        </td>
                    </tr>
                </table>
            </details>
        </td>
    </tr>
</table>
<p><em>Table 2.3.6 FPC statement</em></p>
<h3 id="2354-drng-beacon-payloads"><a class="header" href="#2354-drng-beacon-payloads">2.3.5.4 dRNG beacon payloads</a></h3>
<p>Messages that contain randomness (issued by the dRNG committee nodes). A single <code>Beacon</code> message is not sufficient to reveal the random number. Instead, <code>sigThreshold</code> or more <code>Beacon</code> messages are needed for the random number to be revealed. To recover the random number from the individual <code>Beacon</code> messages, all nodes in the network would need to perform Lagrange interpolation. To avoid that, the committee nodes produce a <code>CollectiveBeacon</code>, which contains a pre-computed random number (meaning that the committee nodes perform the Lagrange interpolation on their own). More information in <a href="./6.6%20dRNG.html">Section 6.5 - Distributed Random Number Generator</a>.
The Table 2.3.7 describes the dRNG <code>Beacon</code> and <code>CollectiveBeacon</code> payload's serialized form.</p>
<table>
    <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
    </tr>
    <tr>
    <tr>
        <td>Size</td>
        <td>uint32</td>
        <td>The size of the payload.</td>
    </tr>
    <tr>
        <td>Payload Type</td>
        <td>uint32</td>
        <td>Set to <strong>6</strong> to denote a <i>Collective Beacon</i> payload or to <strong>5</strong> for <i>Beacon</i> payload.</td>
    </tr>
    <tr>
        <td>Version</td>
        <td>uint8</td>
        <td>The version of the payload.</td>
    </tr>
    <tr>
        <td>InstanceID</td>
        <td>uint32</td>
        <td>The identifier of the dRNG instance.</td>
    </tr>
    </tr>
    <tr>
    <td valign="top">dRNG subpayload <code>oneOf</code></td>
    <td colspan="2">
    <details open="true">
    <summary>TypeBeacon</summary>
    <blockquote>
    Defines payload data for Beacon payload type.
    </blockquote>
    <table>
    <tr>
    <td><b>Name</b></td>
    <td><b>Type</b></td>
    <td><b>Description</b></td>
    </tr>
    <tr>
    <td>Round</td>
    <td>uint64</td>
    <td>The round of the current beacon.</td>
    </tr>
    <tr>
    <td>PartialPK</td>
    <td>ByteArray[96]</td>
    <td>The public key of the issuer.</td>
    </tr>
    <tr>
    <td>PartialSignature</td>
    <td>ByteArray[96]</td>
    <td>The collective signature of the current beacon.</td>
    </tr>
    </table>
    </details>
    <details open="true">
    <summary>TypeCollectiveBeacon</summary>
    <blockquote>
    Defines payload data for CollectiveBeacon payload type.
    </blockquote>
    <table>
    <tr>
    <td><b>Name</b></td>
    <td><b>Type</b></td>
    <td><b>Description</b></td>
    </tr>
    <tr>
    <td>Round</td>
    <td>uint64</td>
    <td>The round of the current beacon.</td>
    </tr>
    <tr>
    <td>PrevSignature</td>
    <td>ByteArray[96]</td>
    <td>The collective signature of the previous beacon.</td>
    </tr>
    <tr>
    <td>Signature</td>
    <td>ByteArray[96]</td>
    <td>The collective signature of the current beacon.</td>
    </tr>
    <tr>
    <td>DistributedPK</td>
    <td>ByteArray[48]</td>
    <td>The distributed public key.</td>
    </tr>
    </table>
    </details>
    </td>
    </tr>
</table>
<p><em>Table 2.3.7 dRNG beacon payload.</em></p>
<h3 id="2355-drng-application-message"><a class="header" href="#2355-drng-application-message">2.3.5.5 dRNG application message</a></h3>
<p>A message used by a node to declare its willingness to participate in the Committee Selection process. Any node can issue an application message. However, low mana nodes are unlikely to be selected; hence, they can decide to not take part in sending application messages. The payload's serialized form is described in Table 2.3.8.</p>
<table>
    <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
    </tr>
    <tr>
        <tr>
            <td>Size</td>
            <td>uint32</td>
            <td>The size of the payload.</td>
        </tr>
        <tr>
            <td>Payload Type</td>
            <td>uint32</td>
            <td>Set to <strong>3</strong> to denote a <i>Application Message</i> payload.</td>
        </tr>
        <tr>
            <td>Version</td>
            <td>uint8</td>
            <td>The version of the payload.</td>
        </tr>
        <tr>
            <td>InstanceID</td>
            <td>uint32</td>
            <td>The identifier of the dRNG instance.</td>
        </tr>
    </tr>
</table>
<p><em>Table 2.3.8 dRNG application message payload.</em></p>
<h3 id="2356-drng-dkg-payload"><a class="header" href="#2356-drng-dkg-payload">2.3.5.6 dRNG DKG payload</a></h3>
<p>The <code>Deal messages</code> exchanged to produce a public/private collective key during the DKG phase (Table 2.3.9). The <code>Deal messages</code> are issued by the nodes that qualified for the dRNG committee participation (see <a href="./6.6%20dRNG.html">Section 6.5 - Distributed Random Number Generator</a>).</p>
<table>
    <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
    </tr>
    <tr>
        <tr>
            <td>Size</td>
            <td>uint32</td>
            <td>The size of the payload.</td>
        </tr>
        <tr>
            <td>Payload Type</td>
            <td>uint32</td>
            <td>Set to <strong>4</strong> to denote a <i>Deal Message</i> payload.</td>
        </tr>
        <tr>
            <td>Version</td>
            <td>uint8</td>
            <td>The version of the payload.</td>
        </tr>
        <tr>
            <td>InstanceID</td>
            <td>uint32</td>
            <td>The identifier of the dRNG instance.</td>
        </tr>
        <tr>
            <td>FromIndex</td>
            <td>uint32</td>
            <td>The index of the dealer.</td>
        </tr>
        <tr>
            <td>ToIndex</td>
            <td>uint32</td>
            <td>The index of the verifier.</td>
        </tr>
        <tr>
    <td valign="top">Deal <code>oneOf</code></td>
    <td colspan="2">
    <details open="true">
    <summary>EncryptedDeal</summary>
    <blockquote>
    An encrypted share struct.
    </blockquote>
    <table>
        <tr>
            <td><b>Name</b></td>
            <td><b>Type</b></td>
            <td><b>Description</b></td>
        </tr>
        <tr>
            <td>Dhkey</td>
            <td>ByteArray</td>
            <td>An ephemeral Diffie-Hellman key.</td>
        </tr>
        <tr>
            <td>Nonce</td>
            <td>ByteArray</td>
            <td>The nonce used in AES-GCM.</td>
        </tr>
        <tr>
            <td>EncryptedShare</td>
            <td>ByteArray</td>
            <td>The ciphertext of the share.</td>
        </tr>
        <tr>
            <td>Threshold</td>
            <td>uint32</td>
            <td>The threshold of the secret sharing protocol (decided during committee selection).</td>
        </tr>
        <tr>
            <td>Commitments</td>
            <td>ByteArray</td>
            <td>The commitments of the polynomial used to derive the share.</td>
        </tr>
    </table>
    </details>
    </tr>
</table>
<p><em>Table 2.3.9 dRNG DKG payload.</em></p>
<h3 id="2357-salt-declaration-payload"><a class="header" href="#2357-salt-declaration-payload">2.3.5.7 Salt declaration payload</a></h3>
<p>The salt declaration payload is used by nodes to declare their initial salt. In a salt declaration message, the declaring node includes the fields specified in Table 2.3.10.</p>
<table>
    <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
    </tr>
    <tr>
    <tr>
        <td>Size</td>
        <td>uint32</td>
        <td>The size of the payload.</td>
    </tr>
    <tr>
        <td>Payload Type</td>
        <td>uint32</td>
        <td>Set to <strong>7</strong> to denote a <i>Salt declaration</i>.</td>
    </tr>
    <tr>
        <td>Version</td>
        <td>uint8</td>
        <td>The version of the payload.</td>
    </tr>
    <tr>
        <td>NodeID</td>
        <td>uint32</td>
        <td>The declaring node ID (which may be different from the node ID of the issuer of the message).</td>
    </tr>
    <tr>
    <td valign="top">Salt <code>oneOf</code></td>
    <td colspan="2">
    <details open="true">
    <summary>Salt</summary>
    <blockquote>
    The public salt of the requester defined.
    </blockquote>
    <table>
        <tr>
            <td><b>Name</b></td>
            <td><b>Type</b></td>
            <td><b>Description</b></td>
        </tr>
        <tr>
            <td>Bytes</td>
            <td>ByteArray</td>
            <td> The value of the salt.</td>
        </tr>
        <tr>
            <td>ExpTime</td>
            <td>time</td>
            <td>The expiration time of the salt.</td>
        </tr>
    </table>
    </details>
    </tr>
    <tr>
        <td>Timestamp</td>
        <td>time</td>
        <td>The timestamp of the payload, which shall be close to the timestamp of its containing message.</td>
    </tr>
    <tr>
        <td>Signature</td>
        <td></td>
        <td>The node signature, that ensures all 'redeclarations' would be malicious.</td>
    </tr>
<table>
<p><em>Table 2.3.10 Salt declaration payload.</em></p>
<h3 id="2358-indexations-payload"><a class="header" href="#2358-indexations-payload">2.3.5.8 Indexations payload</a></h3>
<p>Allows the addition of an index to the encapsulating message, as well as some arbitrary data.
Nodes will expose an API that will enable the querying of messages by the index.
Adding those capabilities may open nodes to DOS attack vectors:</p>
<ol>
<li>Proliferation of index keys that may blow up the node's DB</li>
<li>Proliferation of messages associated with the same index</li>
</ol>
<p>Node implementations may provide weak guarantees regarding the completion of indexes to address the above scenarios.</p>
<p>Besides the index, the payload will also have a data field.
A message that has been attached to the Tangle has several useful properties: verifying that the content of the data did not change 
and determining the approximate time it was published by checking timestamps. If the payload will be incorporated under
the <code>signed transaction payload</code>, the content will be signed as well.</p>
<p>The structure of the payload is presented in Table 2.3.11.</p>
<table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td>Size</td><td>uint32</td><td>The size of the payload.</td></tr>
<tr><td>Payload Type</td><td>uint32</td><td>Set to <strong>8</strong> to denote an <i>Indexation payload</i>.</td></tr>
<tr><td>Version</td><td>uint8</td><td>The version of the payload.</td></tr>
<tr><td>Index</td><td>ByteArray</td><td>The index key of the message.</td></tr>
<tr><td>Data</td><td>ByteArray</td><td>Data we are attaching.</td></tr>
</tbody></table>
<p><em>Table 2.3.11 Indexations payload.</em></p>
<p>Note that <code>index</code> field should be 1 to 64 bytes long for the payload to be valid. The <code>data</code> may have a length of 0.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                                                    <a rel="prev" href="2.2 Message Layout.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                                                    <a rel="next" href="2.4 Data flow.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                    <a rel="prev" href="2.2 Message Layout.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                                    <a rel="next" href="2.4 Data flow.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</html>
